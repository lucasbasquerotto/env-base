name: "{{ params.name | default('test') }}"
ctxs: "{{ params.ctxs | default([]) }}"
migration: ""
container: ""
original_env_schema: "{{ params.env.repo_dir }}/test/schemas/original_env.schema.yml"
meta:
  lax: true
  template_no_empty_lines: true
main:
  local_cloud_hooks:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    cfg: |
      [defaults]
      interpreter_python=/usr/bin/python3
      stdout_callback = default
      collections_paths = collections
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    hooks:
      before_initial_services: "custom-cloud/test/hooks/before_initial_services.yml"
      after_initial_services: "custom-cloud/test/hooks/after_initial_services.yml"
      before_nodes: "custom-cloud/test/hooks/before_nodes.yml"
      after_nodes: "custom-cloud/test/hooks/after_nodes.yml"
      before_wait_nodes: "custom-cloud/test/hooks/before_wait_nodes.yml"
      after_wait_nodes: "custom-cloud/test/hooks/after_wait_nodes.yml"
      before_prepare_nodes: "custom-cloud/test/hooks/before_prepare_nodes.yml"
      after_prepare_nodes: "custom-cloud/test/hooks/after_prepare_nodes.yml"
      before_prepare_pods: "custom-cloud/test/hooks/before_prepare_pods.yml"
      after_prepare_pods: "custom-cloud/test/hooks/after_prepare_pods.yml"
      before_cron: "custom-cloud/test/hooks/before_cron.yml"
      after_cron: "custom-cloud/test/hooks/after_cron.yml"
      before_final_services: "custom-cloud/test/hooks/before_final_services.yml"
      after_final_services: "custom-cloud/test/hooks/after_final_services.yml"
      before_delete_tmp: "custom-cloud/test/hooks/before_delete_tmp.yml"
      after_delete_tmp: "custom-cloud/test/hooks/after_delete_tmp.yml"
      before_delete_main: "custom-cloud/test/hooks/before_delete_main.yml"
      after_delete_main: "custom-cloud/test/hooks/after_delete_main.yml"
  local_cloud_services:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    initial_services:
      - name: "test_list_1"
        absent: true
      - name: "test_service_1_initial"
        key: "test_service_1"
        single: true
        tmp: true
        can_destroy: true
        credentials:
          service_credential_overridden: "my_credential_overridden"
          service_credential_initial: "my_credential_initial"
        contents:
          my_content_initial: |
            My Content Initial
            Line 02
          my_content_overridden: |
            My Content Overridden
            Line 02
        params:
          param1: "value_overridden_1_1"
        group_params:
          param1: "overridden_group_1_1"
          param2: "overridden_group_1_2"
        shared_params: ["overridden_s1"]
        shared_group_params: "overridden_g1"
      - name: "test_service_2_initial"
        key: "test_service_2"
        single: true
        absent: true
        params:
          param1: "value_overridden_2_1"
        group_params:
          param1: "overridden_group_2_1"
          param2: "overridden_group_2_2"
        shared_params: ["overridden_s2"]
        shared_group_params: "overridden_g2"
    final_services:
      - "test_service_3"
      - name: "test_service_1_final"
        key: "test_service_1"
        single: true
        tmp: true
        credentials:
          service_credential_final: "my_credential_final"
        contents:
          my_content_final: |
            My Content Final
            Line 02
        params:
          param1: "value_overridden_1_1"
        group_params:
          param1: "overridden_group_1_1"
          param2: "overridden_group_1_2"
        shared_params: ["overridden_s1"]
        shared_group_params: "overridden_g1"
      - name: "test_list_2_final"
        key: "test_list_2"
        tmp: true
  local_cloud_layer_services:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    initial_services:
      - "test_top_1"
      - name: "test_top_2"
        single: true
        tmp: true
    final_services:
      - name: "test_top_1"
        tmp: true
        can_destroy: true
  local_cloud_sequence_services:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    initial_services:
      - name: "test_sequence"
        tmp: true
  local_repos:
    repo: "cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    extra_repos:
      - repo: "env_base"
        dir: "env-base"
        transfer:
          - src:
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/file1.yml"
            dest: "tmp/test/ef1.yml"
          - src:
              type: "template"
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/template1.yml"
              params:
                value1: "env_base_1_1"
                value2: "env_base_1_2"
            dest: "tmp/test/etpl1.yml"
          - src:
              type: "template"
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/template2.yml"
              params:
                value1: "env_base_2_1"
                value2: "env_base_2_2"
            dest: "tmp/test/etpl2.yml"
          - src:
              origin: "custom"
              file: "test/extra-repos/repo_file1.yml"
            dest: "tmp/test/f1.yml"
          - src:
              file: "test/extra-repos/repo_file2.yml"
            dest: "tmp/test/f2.yml"
          - src:
              type: "template"
              file: "test/extra-repos/repo_template1.yml"
              params:
                value1: "env_base_1_1 (repo)"
                value2: "env_base_1_2 (repo)"
                value3: "env_base_1_3 (repo)"
            dest: "tmp/test/tpl1.yml"
          - src:
              type: "template"
              file: "test/extra-repos/repo_template2.yml"
              params:
                value1: "env_base_2_1 (repo)"
                value2: "env_base_2_2 (repo)"
                value3: "env_base_2_3 (repo)"
            dest: "tmp/test/tpl2.yml"
        links:
          - src: ""
            dest: "tmp/test/link-env-base"
          - repo: "custom_cloud"
            src: ""
            dest: "tmp/test/link-custom-cloud"
          - repo: "pod"
            src: "run"
            dest: "tmp/test/link-pod-run.sh"
      - repo: "custom_cloud"
        dir: "custom-cloud"
        transfer:
          - src:
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/file2.yml"
            dest: "tmp/test/ef2.yml"
          - src:
              type: "template"
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/template1.yml"
              params:
                value1: "custom_cloud_1"
                value2: "custom_cloud_2"
            dest: "tmp/test/etpl1.yml"
          - src:
              type: "file"
              file: "test/extra-repos/cloud_file1.yml"
            dest: "tmp/test/cf1.yml"
          - src:
              file: "test/extra-repos/cloud_file2.yml"
            dest: "tmp/test/cf2.yml"
          - src:
              type: "template"
              file: "test/extra-repos/cloud_template1.yml"
              params:
                value1: "custom_cloud_1_1 (repo)"
                value2: "custom_cloud_1_2 (repo)"
            dest: "tmp/test/ct1.yml"
          - src:
              type: "template"
              file: "test/extra-repos/cloud_template2.yml"
              params:
                value1: "custom_cloud_2_1 (repo)"
                value2: "custom_cloud_2_2 (repo)"
            dest: "tmp/test/ct2.yml"
        links:
          - src: ""
            dest: "tmp/test/link-custom-cloud"
          - repo: "pod"
            src: "run"
            dest: "tmp/test/link-pod-run.sh"
      - repo: "pod"
        dir: "pod"
        transfer:
          - src:
              type: "template"
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/template2.yml"
              params:
                value1: "pod_1"
                value2: "pod_2"
            dest: "tmp/test/etpl2.yml"
        links:
          - repo: "env_base"
            src: ""
            dest: "tmp/test/link-env-base"
      - repo: "custom_pod"
        dir: "custom-pod"
        transfer:
          - src:
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/file1.yml"
            dest: "tmp/test/ef1.yml"
          - src:
              origin: "env"
              file: "{{ params.env.repo_dir }}/test/extra-repos/file2.yml"
            dest: "tmp/test/ef2.yml"
        links:
          - repo: "env_base"
            src: "common/test.yml"
            dest: "tmp/test/link-env-base-test.yml"
          - repo: "env_base"
            src: "test/extra-repos/file1.yml"
            dest: "tmp/test/link-env-base-file.yml"
  pod_local:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
      [host:children]
      test_simple_node_local
      [test_simple_node_local]
    nodes:
      - name: "test_simple_node_local"
        key: "simple_local"
  node_local:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
      [host:children]
      custom_node_service_local
      [custom_node_service_local]
    nodes:
      - name: "test_node_local"
        key: "custom_local"
        local: true
        pods:
          test_pod_local:
            transfer:
              - src: |
                  Test transfer content pod1 ctx
                  Type: str
                dest: "env-transfer/content.str_ctx1.txt"
              - src: |
                  Test transfer content pod1 overridden ctx (overridden ctx)
                  Type: str
                dest: "env-transfer/content.overridden_ctx1.txt"
            params:
              pod_param_1: "ctx overridden value"
            credentials:
              pod_credential_overridden_ctx: "my_credential_pod_overridden_ctx_1"
            contents:
              content_pod_overridden_ctx: |
                Content pod overridden ctx 01
                Line 02
          test_pod_local_2:
            transfer:
              - src: |
                  Test transfer content pod2 ctx
                  Type: str
                dest: "env-transfer/content.str_ctx2.txt"
              - src: |
                  Test transfer content pod2 overridden ctx (overridden ctx)
                  Type: str
                dest: "env-transfer/content.overridden_ctx2.txt"
            params:
              pod_param_1: "ctx overridden value"
            credentials:
              pod_credential_overridden_ctx: "my_credential_pod_overridden_ctx_2"
            contents:
              content_pod_overridden_ctx: |
                Content pod overridden ctx 02
                Line 02
        transfer:
          - src: |
              Test transfer node info content
              Type: str
            dest: "env-transfer/content.node.info_str.txt"
          - src: |
              Test transfer node content overridden (overridden)
              Type: str
            dest: "env-transfer/content.node.overridden.txt"
      - name: "custom_node_service_local"
        amount: 3
        max_amount: 5
    run_stages:
      - tasks:
          - name: "test_task_cloud"
            all_nodes: true
            task_target: "node"
            credentials:
              overridden: "test_task_overridden"
              run_stage: "test_task_run_stage"
            params:
              prop4: "overridden_cloud_1_4"
            shared_params: ["test_task_overridden_1"]
            contents:
              content_task_run_stage: |
                Content Tasks Cloud Run Stage
                Line 02
              content_task_overridden: |
                Content Tasks Cloud Overridden
                Line 02
          - name: "test"
            nodes:
              - name: "test_node_local"
                pods: ["test_pod_local"]
            task_target: "pod"
          - name: "test_skip"
            all_nodes: true
            task_target: "node"
      - tasks:
          - name: "test_task_env"
            nodes: ["test_node_local"]
            task_target: "node"
            params:
              prop4: "overridden_env_1_4"
            shared_params: ["test_task_overridden_1"]
          - name: "test_task_pod_1"
            key: "test_task_pod"
            all_nodes: true
            task_target: "pod"
            params:
              prop4: "overridden_pod_1_4"
            shared_params: ["test_task_overridden_1"]
          - name: "test_task_pod_2"
            key: "test_task_pod"
            nodes:
              - name: "test_node_local"
                pods: ["test_pod_local_2"]
            task_target: "pod"
            params:
              prop4: "overridden_pod_2_4"
            shared_params: ["test_task_overridden_2"]
  node:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts:
      type: "template"
      file: "files/hosts.tpl.ini"
      schema: "files/hosts.schema.yml"
    initial_services:
      - "{{ params.env_params.vpn_service | default({}) }}"
    nodes: "{{ params.env_params.nodes | default([]) }}"
    original_env_schema: "{{ params.env.repo_dir }}/test/schemas/original_env.node.schema.yml"
  services:
    repo: "cloud"
    env_repos:
      - repo: "custom_cloud"
        dir: "custom-cloud"
    hosts: |
      [main]
      localhost ansible_connection=local
      [host]
    initial_services: "{{ params.env_params.services | default([]) }}"
    original_env_schema: "{{ params.env.repo_dir }}/test/schemas/original_env.services.schema.yml"
services:
  digital_ocean_vpn:
    base_dir: "custom-cloud"
    namespace: "ext_vpn"
    task: "tasks/vpn/digital_ocean.main.vpn.yml"
    schema: "tasks/vpn/digital_ocean.schema.vpn.yml"
    credentials:
      vpn: "digital_ocean"
    params:
      tags:
        - "auto"
        - "dmz"
      firewalls:
        - name: "private"
          tags: ["auto"]
          inbound_rules:
            - ports: "9080"
              sources:
                addresses: "{{ params.env_params.private_ips | default([]) }}"
            - ports: "9443"
              sources:
                addresses: "{{ params.env_params.private_ips | default([]) }}"
        - name: "auto"
          tags: ["auto"]
          inbound_rules:
            - ports: "22"
              sources:
                tags: ["main"]
                addresses: "{{ params.env_params.private_ips | default([]) }}"
          outbound_rules:
            - protocol: "tcp"
              ports: "1-65535"
              destinations:
                addresses: ["0.0.0.0/0", "::/0"]
            - protocol: "udp"
              ports: "1-65535"
              destinations:
                addresses: ["0.0.0.0/0", "::/0"]
            - protocol: "icmp"
              ports: "1-65535"
              destinations:
                addresses: ["0.0.0.0/0", "::/0"]
        - name: "dmz"
          tags: ["dmz"]
          inbound_rules:
            - ports: "80"
              sources:
                addresses: ["0.0.0.0/0", "::/0"]
            - ports: "443"
              sources:
                addresses: ["0.0.0.0/0", "::/0"]
  service_dns:
    base_dir: "custom-cloud"
    namespace: "ext_dns"
    task: "tasks/dns/{{ params.env_params.dns_provider | default('') }}.main.dns.yml"
    schema: "tasks/dns/{{ params.env_params.dns_provider | default('') }}.schema.dns.yml"
    credentials:
      dns: "{{ params.env_params.dns_provider | default('') }}"
    params:
      zone: "{{ params.env_params.domain | default('') }}"
      dns_type: "A"
      record: "dev"
      value: "{{ params.env_params.dns_records | default([]) }}"
  service_s3:
    base_dir: "custom-cloud"
    namespace: "ext_s3"
    task: "tasks/s3/aws.main.s3.yml"
    schema: "tasks/s3/schema.s3.yml"
    credentials:
      s3: "s3"
    params:
      bucket: "{{ params.env_params.s3_bucket | default('') }}"
      permission: "public-read"
  digital_ocean_node_service:
    base_dir: "custom-cloud"
    namespace: "ext_node"
    task: "tasks/node/digital_ocean.main.node.yml"
    schema: "tasks/node/digital_ocean.schema.node.yml"
    credentials:
      node: "digital_ocean"
    params:
      image_id: "ubuntu-18-04-x64"
      ipv6: true
      region_id: "ams3"
      size_id: "s-1vcpu-1gb"
      tags:
        - "auto"
        - "dmz"
    contents:
      user_data:
        type: "template"
        origin: "cloud"
        file: "custom-cloud/files/user-data/ubuntu-18.04.tpl.sh"
        schema: "custom-cloud/files/user-data/ubuntu-18.04.schema.yml"
        params:
          install_docker: true
          install_podman: false
          install_packages: false
        credentials:
          node: "host"
        contents:
          host_ssh_public_keys: "{{ params.env_params.host_ssh_public_keys_content | default('') }}"
  node_dns_service:
    base_dir: "custom-cloud"
    namespace: "ext_dns"
    task: "tasks/dns/{{ params.env_params.dns_provider | default('') }}.main.dns.yml"
    schema: "tasks/dns/{{ params.env_params.dns_provider | default('') }}.schema.dns.yml"
    credentials:
      dns: "{{ params.env_params.dns_provider | default('') }}"
    params:
      zone: "{{ params.env_params.domain | default('') }}"
  service_simple_node_local:
    base_dir: "custom-cloud"
    namespace: "ext_node"
    task: "test/services/node/test.main.node.yml"
    schema: "test/services/node/test.schema.node.yml"
  service_node_local:
    base_dir: "custom-cloud"
    namespace: "ext_node"
    task: "test/services/node/test.main.node.yml"
    schema: "test/services/node/test.schema.node.yml"
    credentials:
      node: "node_service_local_credential"
    contents:
      user_data:
        type: "template"
        origin: "cloud"
        file: "custom-cloud/test/services/node/files/user-data-content.tpl.sh"
        schema: "custom-cloud/test/services/node/files/user-data-content.schema.yml"
        credentials:
          node: "host"
        contents:
          host_ssh_public_keys: "{{ params.env_params.host_ssh_public_keys_content | default('') }}"
    params:
      prop1: "test value 1"
      user_datas:
        - |
          User Data 1 1
          User Data 1 2
          User Data 1 3
        - type: "str"
          params:
            value: |
              User Data 2 1
              User Data 2 2
              User Data 2 3
        - type: "str"
          shared_params: ["user_data_str"]
        - type: "env"
          name: "user_data_str_1"
        - type: "env"
          name: "user_data_str_2_custom_name"
          key: "user_data_str_2"
        - type: "env"
          name: "user_data_str_3"
        - type: "file"
          file: "custom-cloud/test/services/node/files/user-data.sh"
        - type: "env"
          name: "user_data_file_1"
          key: "user_data_file"
        - type: "template"
          file: "custom-cloud/test/services/node/files/user-data.tpl.sh"
          params:
            prop1: "value_1"
          group_params:
            prop1: "user_data_1"
            prop2: "user_data_2"
          shared_params: ["user_data_1", "user_data_2"]
          shared_group_params: "user_data"
        - type: "env"
          name: "user_data_tpl_1"
          key: "user_data_tpl"
          params:
            prop1: "value_overridden_1"
          group_params:
            prop1: "user_data_overridden_1"
            prop2: "user_data_overridden_2"
          shared_params: ["user_data_overridden_1", "user_data_overridden_2"]
          shared_group_params: "user_data_overridden"
        - type: "env"
          name: "user_data_tpl_2"
          key: "user_data_tpl"
          params:
            prop3: "value_overridden_3"
          group_params:
            prop1: "user_data_overridden_1"
        - type: "env"
          name: "user_data_tpl_env_1"
          key: "user_data_tpl_env"
          params:
            prop1: "value_overridden_env_1"
          group_params:
            prop1: "user_data_overridden_1"
            prop2: "user_data_overridden_2"
          shared_params: ["user_data_overridden_1", "user_data_overridden_2"]
          shared_group_params: "user_data_overridden"
        - type: "env"
          name: "user_data_tpl_env_2"
          key: "user_data_tpl_env"
          params:
            prop3: "value_overridden_env_3"
          group_params:
            prop1: "user_data_overridden_1"
  test_service_1:
    base_dir: "custom-cloud"
    task: "test/services/general/01.yml"
    credentials:
      service_credential_1: "my_credential_1_1"
      service_credential_2: "my_credential_1_2"
      service_credential_overridden: "my_credential_1_1"
    params:
      param1: "value_1_1"
    group_params:
      param1: "group_1_1"
      param2: "group_1_2"
    shared_params: ["value_s1"]
    shared_group_params: "value_g1"
    contents:
      my_content_1: |
        My Content 01
        Line 02
      my_content_2: |
        My Content 02
        Line 02
      my_content_overridden: |
        My Content (Overridden)
        Line 02
  test_service_2:
    base_dir: "custom-cloud"
    task: "test/services/general/02.yml"
    credentials:
      service_credential_1: "my_credential_2_1"
      service_credential_2: "my_credential_2_2"
    params:
      param1: "value_2_1"
    group_params:
      param1: "group_2_1"
      param2: "group_2_2"
    shared_params: ["value_s2"]
    shared_group_params: "value_g2"
  test_service_3:
    base_dir: "custom-cloud"
    task: "test/services/general/03.yml"
    credentials:
      service_credential_1: "my_credential_3_1"
      service_credential_2: "my_credential_3_2"
    params:
      param1: "value_3_1"
    group_params:
      param1: "group_3_1"
      param2: "group_3_2"
    shared_params: ["value_s3"]
    shared_group_params: "value_g3"
  test_list_1:
    list: true
    services:
      - name: "test_service_1"
        single: true
      - name: "test_service_2_overridden"
        key: "test_service_2"
        single: true
        credentials:
          service_credential_overridden: "my_credential_overridden"
  test_list_2:
    list: true
    services:
      - name: "test_list_2_list_1"
        key: "test_list_1"
        single: false
      - name: "test_list_2_service_2"
        key: "test_service_2"
        single: true
        absent: true
        params:
          param1: "value_overridden_2_1"
        group_params:
          param1: "overridden_group_2_1"
          param2: "overridden_group_2_2"
        shared_params: ["overridden_s2"]
        shared_group_params: "overridden_g2"
  test_list_3:
    list: true
    services:
      - name: "test_list_3_service_2"
        single: true
        key: "test_service_2"
  test_top_1:
    base_dir: "custom-cloud"
    task: "test/services/layer/top.yml"
    namespace: "ext_test_top"
    credentials:
      service_credential_top_1: "my_credential_top_1_1"
      service_credential_top_2: "my_credential_top_1_2"
    params:
      result_service_name: "test_top_1_middle_1"
      result_value: "test_top_1"
      services:
        - name: "test_top_1_middle_1"
          key: "test_middle_1"
          single: true
          params:
            result_value: "value_top_1_middle_1"
        - name: "test_top_1_bottom_1"
          key: "test_bottom_1"
          single: true
      param1: "value_top_1_1"
    group_params:
      param1: "group_top_1_1"
      param2: "group_top_1_2"
    shared_params: ["value_top_s1"]
    shared_group_params: "value_top_g1"
  test_middle_1:
    base_dir: "custom-cloud"
    task: "test/services/layer/middle.yml"
    namespace: "ext_test_middle"
    credentials:
      service_credential_middle_1: "my_credential_middle_1_1"
      service_credential_middle_2: "my_credential_middle_1_2"
    params:
      result_service_name: "test_middle_1_bottom_1"
      services:
        - name: "test_middle_1_bottom_1"
          key: "test_bottom_1"
          single: true
          params:
            result_value: "value_middle_1_bottom_1"
        - name: "test_middle_1_list_1"
          key: "test_list_1"
          single: false
      param1: "value_middle_1_1"
    group_params:
      param1: "group_middle_1_1"
      param2: "group_middle_1_2"
    shared_params: ["value_middle_s1"]
    shared_group_params: "value_middle_g1"
  test_bottom_1:
    base_dir: "custom-cloud"
    task: "test/services/layer/bottom.yml"
    namespace: "ext_test_bottom"
    credentials:
      service_credential_bottom_1: "my_credential_bottom_1_1"
      service_credential_bottom_2: "my_credential_bottom_1_2"
    params:
      result_value: "value_bottom_1"
      param1: "value_bottom_1_1"
    group_params:
      param1: "group_bottom_1_1"
      param2: "group_bottom_1_2"
    shared_params: ["value_bottom_s1"]
    shared_group_params: "value_bottom_g1"
  test_top_2:
    base_dir: "custom-cloud"
    task: "test/services/layer/top.yml"
    namespace: "ext_test_top"
    credentials:
      service_credential_top_1: "my_credential_top_2_1"
      service_credential_top_2: "my_credential_top_2_2"
    params:
      services:
        - name: "test_top_2_middle_1"
          key: "test_middle_1"
        - name: "test_top_2_middle_2"
          key: "test_middle_2"
      param1: "value_top_2_1"
    group_params:
      param1: "group_top_2_1"
      param2: "group_top_2_2"
    shared_params: ["value_top_s2"]
    shared_group_params: "value_top_g2"
  test_middle_2:
    base_dir: "custom-cloud"
    task: "test/services/layer/middle.yml"
    namespace: "ext_test_middle"
    credentials:
      service_credential_middle_1: "my_credential_middle_2_1"
      service_credential_middle_2: "my_credential_middle_2_2"
    params:
      services:
        - name: "test_middle_2_bottom_1"
          key: "test_bottom_1"
        - name: "test_middle_2_bottom_2"
          key: "test_bottom_2"
      param1: "value_middle_2_1"
    group_params:
      param1: "group_middle_2_1"
      param2: "group_middle_2_2"
    shared_params: ["value_middle_s2"]
    shared_group_params: "value_middle_g2"
  test_bottom_2:
    base_dir: "custom-cloud"
    task: "test/services/layer/bottom.yml"
    namespace: "ext_test_bottom"
    credentials:
      service_credential_bottom_1: "my_credential_bottom_2_1"
      service_credential_bottom_2: "my_credential_bottom_2_2"
    params:
      result_value: "value_bottom_2"
      param1: "value_bottom_2_1"
    group_params:
      param1: "group_bottom_2_1"
      param2: "group_bottom_2_2"
    shared_params: ["value_bottom_s2"]
    shared_group_params: "value_bottom_g2"
  test_sequence:
    list: true
    services:
      - name: "test_before_sequence"
        key: "test_before"
        single: true
      - name: "test_after_no_sequence_1"
        key: "test_after"
        params:
          param_changed: "after_value_no_sequence_1"
      - name: "test_adapter_sequence"
        key: "test_adapter"
        single: true
        params:
          input_service: "test_before_sequence"
      - name: "test_after_no_sequence_2"
        key: "test_after"
        params:
          param_changed: "after_value_no_sequence_2"
      - name: "test_after_sequence"
        key: "test_after"
        single: true
        params:
          input_service: "test_adapter_sequence"
      - name: "test_after_no_sequence_3"
        key: "test_after"
        params:
          param_changed: "after_value_no_sequence_3"
  test_before:
    base_dir: "custom-cloud"
    task: "test/services/sequence/before.yml"
    namespace: "ext_test_before"
    params:
      param_1: "value_1"
      param_2: "value_2"
  test_adapter:
    base_dir: "custom-cloud"
    task: "test/services/sequence/adapter.yml"
    namespace: "ext_test_adapter"
  test_after:
    base_dir: "custom-cloud"
    task: "test/services/sequence/after.yml"
    namespace: "ext_test_after"
    params:
      param_unchanged: "after_value"
service_shared_group_params:
  value_g1:
    param1: "shared_1_1"
    param2: "shared_1_2"
    param3: "shared_1_3"
    param4: "shared_1_4"
  overridden_g1:
    param1: "overridden_shared_1_1"
    param2: "overridden_shared_1_2"
    param3: "overridden_shared_1_3"
    param4: "overridden_shared_1_4"
  value_g2:
    param1: "shared_2_1"
    param2: "shared_2_2"
    param3: "shared_2_3"
    param4: "shared_2_4"
  overridden_g2:
    param1: "overridden_shared_2_1"
    param2: "overridden_shared_2_2"
    param3: "overridden_shared_2_3"
    param4: "overridden_shared_2_4"
  value_g3:
    param1: "shared_3_1"
    param2: "shared_3_2"
    param3: "shared_3_3"
    param4: "shared_3_4"
  value_top_g1:
    param1: "shared_top_1_1"
    param2: "shared_top_1_2"
    param3: "shared_top_1_3"
    param4: "shared_top_1_4"
  value_middle_g1:
    param1: "shared_middle_1_1"
    param2: "shared_middle_1_2"
    param3: "shared_middle_1_3"
    param4: "shared_middle_1_4"
  value_bottom_g1:
    param1: "shared_bottom_1_1"
    param2: "shared_bottom_1_2"
    param3: "shared_bottom_1_3"
    param4: "shared_bottom_1_4"
  value_top_g2:
    param1: "shared_top_2_1"
    param2: "shared_top_2_2"
    param3: "shared_top_2_3"
    param4: "shared_top_2_4"
  value_middle_g2:
    param1: "shared_middle_2_1"
    param2: "shared_middle_2_2"
    param3: "shared_middle_2_3"
    param4: "shared_middle_2_4"
  value_bottom_g2:
    param1: "shared_bottom_2_1"
    param2: "shared_bottom_2_2"
    param3: "shared_bottom_2_3"
    param4: "shared_bottom_2_4"
service_shared_params:
  value_s1:
    param1: "value_shared_1_1"
    param2: "value_shared_1_2"
    param3: "value_shared_1_3"
  overridden_s1:
    param1: "value_overridden_shared_1_1"
    param2: "value_overridden_shared_1_2"
    param3: "value_overridden_shared_1_3"
  value_s2:
    param1: "value_shared_2_1"
    param2: "value_shared_2_2"
    param3: "value_shared_2_3"
  overridden_s2:
    param1: "value_overridden_shared_2_1"
    param2: "value_overridden_shared_2_2"
    param3: "value_overridden_shared_2_3"
  value_s3:
    param1: "value_shared_3_1"
    param2: "value_shared_3_2"
    param3: "value_shared_3_3"
  value_top_s1:
    param1: "value_shared_top_1_1"
    param2: "value_shared_top_1_2"
    param3: "value_shared_top_1_3"
  value_middle_s1:
    param1: "value_shared_middle_1_1"
    param2: "value_shared_middle_1_2"
    param3: "value_shared_middle_1_3"
  value_bottom_s1:
    param1: "value_shared_bottom_1_1"
    param2: "value_shared_bottom_1_2"
    param3: "value_shared_bottom_1_3"
  value_top_s2:
    param1: "value_shared_top_2_1"
    param2: "value_shared_top_2_2"
    param3: "value_shared_top_2_3"
  value_middle_s2:
    param1: "value_shared_middle_2_1"
    param2: "value_shared_middle_2_2"
    param3: "value_shared_middle_2_3"
  value_bottom_s2:
    param1: "value_shared_bottom_2_1"
    param2: "value_shared_bottom_2_2"
    param3: "value_shared_bottom_2_3"
service_group_params:
  group_1_1: "value_group_1_1"
  group_1_2: "value_group_1_2"
  overridden_group_1_1: "value_overridden_group_1_1"
  overridden_group_1_2: "value_overridden_group_1_2"
  shared_1_1: "value_group_shared_1_1"
  shared_1_2: "value_group_shared_1_2"
  shared_1_3: "value_group_shared_1_3"
  shared_1_4: "value_group_shared_1_4"
  overridden_shared_1_1: "value_overridden_group_shared_1_1"
  overridden_shared_1_2: "value_overridden_group_shared_1_2"
  overridden_shared_1_3: "value_overridden_group_shared_1_3"
  overridden_shared_1_4: "value_overridden_group_shared_1_4"
  group_2_1: "value_group_2_1"
  group_2_2: "value_group_2_2"
  overridden_group_2_1: "value_overridden_group_2_1"
  overridden_group_2_2: "value_overridden_group_2_2"
  shared_2_1: "value_group_shared_2_1"
  shared_2_2: "value_group_shared_2_2"
  shared_2_3: "value_group_shared_2_3"
  shared_2_4: "value_group_shared_2_4"
  overridden_shared_2_1: "value_overridden_group_shared_2_1"
  overridden_shared_2_2: "value_overridden_group_shared_2_2"
  overridden_shared_2_3: "value_overridden_group_shared_2_3"
  overridden_shared_2_4: "value_overridden_group_shared_2_4"
  group_3_1: "value_group_3_1"
  group_3_2: "value_group_3_2"
  shared_3_1: "value_group_shared_3_1"
  shared_3_2: "value_group_shared_3_2"
  shared_3_3: "value_group_shared_3_3"
  shared_3_4: "value_group_shared_3_4"
  group_top_1_1: "value_group_top_1_1"
  group_top_1_2: "value_group_top_1_2"
  group_middle_1_1: "value_group_middle_1_1"
  group_middle_1_2: "value_group_middle_1_2"
  group_bottom_1_1: "value_group_bottom_1_1"
  group_bottom_1_2: "value_group_bottom_1_2"
  shared_top_1_1: "value_group_shared_top_1_1"
  shared_top_1_2: "value_group_shared_top_1_2"
  shared_top_1_3: "value_group_shared_top_1_3"
  shared_top_1_4: "value_group_shared_top_1_4"
  shared_middle_1_1: "value_group_shared_middle_1_1"
  shared_middle_1_2: "value_group_shared_middle_1_2"
  shared_middle_1_3: "value_group_shared_middle_1_3"
  shared_middle_1_4: "value_group_shared_middle_1_4"
  shared_bottom_1_1: "value_group_shared_bottom_1_1"
  shared_bottom_1_2: "value_group_shared_bottom_1_2"
  shared_bottom_1_3: "value_group_shared_bottom_1_3"
  shared_bottom_1_4: "value_group_shared_bottom_1_4"
  group_top_2_1: "value_group_top_2_1"
  group_top_2_2: "value_group_top_2_2"
  group_middle_2_1: "value_group_middle_2_1"
  group_middle_2_2: "value_group_middle_2_2"
  group_bottom_2_1: "value_group_bottom_2_1"
  group_bottom_2_2: "value_group_bottom_2_2"
  shared_top_2_1: "value_group_shared_top_2_1"
  shared_top_2_2: "value_group_shared_top_2_2"
  shared_top_2_3: "value_group_shared_top_2_3"
  shared_top_2_4: "value_group_shared_top_2_4"
  shared_middle_2_1: "value_group_shared_middle_2_1"
  shared_middle_2_2: "value_group_shared_middle_2_2"
  shared_middle_2_3: "value_group_shared_middle_2_3"
  shared_middle_2_4: "value_group_shared_middle_2_4"
  shared_bottom_2_1: "value_group_shared_bottom_2_1"
  shared_bottom_2_2: "value_group_shared_bottom_2_2"
  shared_bottom_2_3: "value_group_shared_bottom_2_3"
  shared_bottom_2_4: "value_group_shared_bottom_2_4"
nodes:
  digital_ocean_node:
    service: "digital_ocean_node_service"
    dns_service: "node_dns_service"
    base_dir: "/var/cloud"
    credential: "host"
    root: true
    pods:
      - name: "test_pod"
        key: "custom"
        credentials:
          pod_credential_node: "my_credential_pod_node_1"
        params:
          pod_param_4: "value_4"
        contents:
          content_pod_node: |
            Content pod remote node 01
            Line 02
    params:
      dns_service_params_list:
        - record: "test1"
          ttl: 100
        - record: "test2"
          ttl: 200
      host_test:
        setup_log_file: "/var/log/setup.log"
        setup_finished_log_regex: "^Setup Finished.*$"
        setup_success_log_last_line: "Setup Finished - Success"
        initial_connection_timeout: 90
        setup_finished_timeout: 300
  simple_local:
    service: "service_simple_node_local"
    base_dir: "/var/cloud"
    credential: "localhost"
    params:
      host_test:
        setup_log_file: "/var/log/setup.log"
        setup_finished_log_regex: "Setup Finished"
        setup_success_log_last_line: "Setup Finished"
        initial_connection_timeout: 3
        setup_finished_timeout: 5
    pods: ["simple"]
  custom_local:
    pods:
      - name: "test_pod_local"
        key: "custom"
        transfer:
          - src: |
              Test transfer content pod1
              Type: str
            dest: "env-transfer/content.str1.txt"
          - src: |
              Test transfer content pod1 overridden (overridden)
              Type: str
            dest: "env-transfer/content.overridden1.txt"
          - src: |
              Test transfer content pod1 overridden (overridden ctx)
              Type: str
            dest: "env-transfer/content.overridden_ctx1.txt"
        params:
          pod_param_2: "node overridden value"
        credentials:
          pod_credential_node: "my_credential_pod_node_1"
          pod_credential_overridden: "my_credential_pod_overridden_1"
          pod_credential_overridden_ctx: "my_credential_pod_node_1"
        contents:
          content_pod_node: |
            Content pod node 01
            Line 02
          content_pod_overridden: |
            Content pod overridden 01 (node pod)
            Line 02
          content_pod_overridden_ctx: |
            Content pod overridden 01 (node pod - ctx)
            Line 02
      - name: "test_pod_local_2"
        key: "custom"
        transfer:
          - src: |
              Test transfer content pod2
              Type: str
            dest: "env-transfer/content.str2.txt"
          - src: |
              Test transfer content pod2 overridden (overridden)
              Type: str
            dest: "env-transfer/content.overridden2.txt"
          - src: |
              Test transfer content pod2 overridden (overridden ctx)
              Type: str
            dest: "env-transfer/content.overridden_ctx2.txt"
        params:
          pod_param_2: "node overridden value"
        credentials:
          pod_credential_node: "my_credential_pod_node_2"
          pod_credential_overridden: "my_credential_pod_overridden_2"
          pod_credential_overridden_ctx: "my_credential_pod_node_2"
        contents:
          content_pod_node: |
            Content pod node 02
            Line 02
          content_pod_overridden: |
            Content pod overridden 02 (node pod)
            Line 02
          content_pod_overridden_ctx: |
            Content pod overridden 02 (node pod - ctx)
            Line 02
    transfer:
      - src: |
          Test transfer node content
          Type: str
        dest: "env-transfer/content.node.str.txt"
      - src:
          file: "custom-cloud/test/extra-repos/cloud_file1.yml"
        dest: "env-transfer/content.node.file.sh"
      - src:
          type: "template"
          file: "custom-cloud/test/extra-repos/cloud_template1.yml"
          params:
            value1: "transfer node content value1"
            value2: "transfer node content value2"
        dest: "env-transfer/content.node.template.sh"
      - src:
          origin: "env"
          file: "{{ params.env.repo_dir }}/test/extra-repos/file1.yml"
        dest: "env-transfer/content.node.env_file.yml"
      - src:
          type: "template"
          origin: "env"
          file: "{{ params.env.repo_dir }}/test/extra-repos/template1.yml"
          params:
            value1: "transfer node env content template value 1"
            value2: "transfer node env content template value 2"
        dest: "env-transfer/content.node.env_template.yml"
      - src: |
          Test transfer node content (overridden)
          Type: str
        dest: "env-transfer/content.node.overridden.txt"
      - src:
          type: "template"
          origin: "env"
          file: "{{ params.env.repo_dir }}/test/files/template.content.tpl.yml"
          schema: "{{ params.env.repo_dir }}/test/files/template.content.schema.yml"
          credentials:
            cred1: "node_cred_content_1"
            cred2: "node_cred_content_2"
          params:
            value1: "transfer node env main content template value 1"
            value2: "transfer node env main content template value 2"
        dest: "env-transfer/content.node.env_template.content.yml"
    params:
      host_test:
        setup_log_file: "/var/log/setup.log"
        setup_finished_log_regex: "Setup Finished"
        setup_success_log_last_line: "Setup Finished"
        initial_connection_timeout: 3
        setup_finished_timeout: 5
      cron:
        - user: "root"
          src:
            origin: "env"
            file: "{{ params.env.repo_dir }}/cron/app.cron"
          dest: "/var/spool/cron/crontabs/root"
  custom_node_service_local:
    service: "service_node_local"
    base_dir: "/var/cloud"
    credential: "localhost"
    params:
      host_test:
        setup_log_file: "/var/log/setup.log"
        setup_finished_log_regex: "Setup Finished"
        setup_success_log_last_line: "Setup Finished"
        initial_connection_timeout: 3
        setup_finished_timeout: 5
pods:
  simple:
    repo: "custom_pod"
    ctx: "test/ctx-simple.yml"
    schema: "test/simple.schema.yml"
    root: true
    fast_prepare: true
    params:
      env_files_dir: "{{ params.env.repo_dir }}/test/files"
      test_schema:
        - 123
        - { p1: [{ p1: [456, { p1: 111 }] }, 012, { p1: 123 }] }
        - 789
        - { p1: 000 }
      pod_param_1: "sample value 1"
      pod_param_2: "sample value 2"
      pod_param_3: "sample value 3"
  custom:
    repo: "pod"
    env_repos:
      - repo: "custom_pod"
        dir: "custom-pod"
    ctx: "custom-pod/test/ctx.yml"
    schema: "custom-pod/test/schema.yml"
    root: true
    fast_prepare: true
    transfer:
      - dest: "env-transfer/content.str.txt"
        src: |
          Test transfer content
          Type: str
      - dest: "env-transfer/content.file.sh"
        src:
          file: "custom-pod/test/run.sh"
      - dest: "env-transfer/content.template.sh"
        src:
          type: "template"
          file: "custom-pod/test/template.sh"
          params:
            value: "transfer content value"
      - dest: "env-transfer/content.env_file.yml"
        src:
          origin: "env"
          file: "{{ params.env.repo_dir }}/test/extra-repos/file1.yml"
      - dest: "env-transfer/content.env_template.yml"
        src:
          type: "template"
          origin: "env"
          file: "{{ params.env.repo_dir }}/test/extra-repos/template1.yml"
          params:
            value1: "transfer content template value 1"
            value2: "transfer content template value 2"
      - dest: "env-transfer/content.overridden1.txt"
        src: |
          Test transfer content pod1 (overridden)
          Type: str
      - dest: "env-transfer/content.overridden_ctx1.txt"
        src: |
          Test transfer content pod1 (overridden ctx)
          Type: str
      - dest: "env-transfer/content.overridden2.txt"
        src: |
          Test transfer content pod2 (overridden)
          Type: str
      - dest: "env-transfer/content.overridden_ctx2.txt"
        src: |
          Test transfer content pod2 (overridden ctx)
          Type: str
      - dest: "env-transfer/user_data.sh"
        mode: "777"
        src:
          type: "template"
          origin: "cloud"
          file: "custom-cloud/test/services/node/files/user-data-content.tpl.sh"
          schema: "custom-cloud/test/services/node/files/user-data-content.schema.yml"
          credentials:
            node: "host"
          contents:
            host_ssh_public_keys: "{{ params.env_params.host_ssh_public_keys_content | default('') }}"
      - dest: "env-transfer/content-type-env.str.txt"
        src:
          type: "env"
          name: "str_overridden"
          params:
            value: |
              My string content overridden
              Line 02
      - dest: "env-transfer/content-type-env.tpl.txt"
        src:
          type: "env"
          name: "tpl_overridden_nested"
          params:
            param_top: "value top"
            param_overridden_top: "value overridden top"
          credentials:
            credential_top: "my_credential_top"
            credential_overridden_top: "my_credential_overridden_top"
          contents:
            content_top: |
              Content Top
              Line 02
            content_overridden_top: |
              Content Overridden Top
              Line 02
    credentials:
      pod_credential_1: "my_credential_1_1"
      pod_credential_2: "my_credential_1_2"
      pod_credential_overridden: "my_credential_1_1"
      pod_credential_overridden_ctx: "my_credential_1_2"
    contents:
      content_pod_1: |
        Content pod 01
        Line 02
      content_pod_2:
        type: "str"
        params:
          value: |
            Content pod 02
            Line 02
      content_pod_overridden: |
        Content pod (pod - overridden)
        Line 02
      content_pod_overridden_ctx: |
        Content pod (pod - overridden ctx)
        Line 02
      user_data:
        type: "template"
        origin: "cloud"
        file: "custom-cloud/test/services/node/files/user-data-content.tpl.sh"
        schema: "custom-cloud/test/services/node/files/user-data-content.schema.yml"
        credentials:
          node: "host"
        contents:
          host_ssh_public_keys: "{{ params.env_params.host_ssh_public_keys_content | default('') }}"
    params:
      custom_dir: "custom-pod"
      env_files_dir: "{{ params.env.repo_dir }}/test/files"
      test_schema:
        - 123
        - { p1: [{ p1: [456, { p1: 111 }] }, 012, { p1: 123 }] }
        - 789
        - { p1: 000 }
      pod_param_1: "value_1"
      pod_param_2: "value_2"
      pod_param_3: "value_3"
tasks:
  test_task_cloud:
    type: "task"
    root: true
    file: "custom-cloud/test/run-tasks/task.yml"
    schema: "custom-cloud/test/run-tasks/task.schema.yml"
    credentials:
      prop1: "test_task_prop1_cloud"
      prop2: "test_task_prop2"
      prop4: "test_task_prop4"
      prop5: "test_task_prop5"
      overridden: "test_task_prop1_cloud"
    shared_params: ["test_task", "test_task_cloud"]
    group_params:
      prop3: "test_task_prop3"
    contents:
      content_task: |
        Content Tasks Cloud
        Line 02
      content_task_overridden: |
        Content Tasks Cloud (Overridden)
        Line 02
  test_task_env:
    type: "task"
    target_origin: "env"
    root: true
    file: "{{ params.env.repo_dir }}/test/run-tasks/task.yml"
    schema: "{{ params.env.repo_dir }}/test/run-tasks/task.schema.yml"
    credentials:
      prop1: "test_task_prop1_env"
      prop2: "test_task_prop2"
      prop4: "test_task_prop4"
      prop5: "test_task_prop5"
    contents:
      content_1: |
        Content env run task 01
        Line 02
      content_2:
        type: "str"
        params:
          value: |
            Content env run task 02
            Line 02
    shared_params: ["test_task", "test_task_env"]
    group_params:
      prop3: "test_task_prop3"
  test_task_pod:
    type: "task"
    target_origin: "pod"
    root: true
    file: "custom-pod/test/run-tasks/task.yml"
    schema: "custom-pod/test/run-tasks/task.schema.yml"
    credentials:
      prop1: "test_task_prop1_pod"
      prop2: "test_task_prop2"
      prop4: "test_task_prop4"
      prop5: "test_task_prop5"
    contents:
      content_task_1: |
        Content pod run task 01
        Line 02
      content_task_2:
        type: "str"
        params:
          value: |
            Content pod run task 02
            Line 02
    shared_params: ["test_task", "test_task_pod"]
    group_params:
      prop3: "test_task_prop3"
  test:
    type: "shell"
    cmd: "bash custom-pod/test/run.sh"
  test_skip:
    type: "skip"
task_shared_params:
  test_task:
    prop1: "value1"
    prop2:
      inner_prop1: "inner_value1"
      inner_prop2:
        inner_prop1: "inner2_2_value1"
      inner_prop3:
        inner_prop1: "inner2_3_value1"
  test_task_cloud:
    prop1: "value1_cloud"
  test_task_env:
    prop1: "value1_env"
  test_task_pod:
    prop1: "value1_pod"
  test_task_overridden_1:
    prop4: "overridden_shared_1_4"
    prop5: "overridden_shared_1_5"
  test_task_overridden_2:
    prop4: "overridden_shared_2_4"
    prop5: "overridden_shared_2_5"
task_group_params:
  test_task_prop3:
    inner_prop1: "inner3_value1"
    inner_prop2:
      inner_prop1: "inner3_2_value1"
      inner_prop2:
        inner_prop1: "inner3_2_2_value1"
        inner_prop3:
          inner_prop1: "inner3_2_2_3_value1"
    inner_prop3:
      inner_prop1: "inner3_3_value1"
contents:
  user_data_str_1: |
    User Data Env 1 1
    User Data Env 1 2
    User Data Env 1 3
  user_data_str_2:
    type: "str"
    params:
      value: |
        User Data Env 2 1
        User Data Env 2 2
        User Data Env 2 3
  user_data_str_3:
    type: "str"
    shared_params: ["user_data_env_str"]
  user_data_file:
    type: "file"
    file: "custom-cloud/test/services/node/files/user-data.sh"
  user_data_file_env:
    type: "file"
    origin: "env"
    file: "{{ params.env.repo_dir }}/test/files/user-data.sh"
  user_data_tpl:
    type: "template"
    file: "custom-cloud/test/services/node/files/user-data.tpl.sh"
    params:
      prop1: "value_env_1"
    group_params:
      prop1: "user_data_1"
      prop2: "user_data_2"
    shared_params: ["user_data_1", "user_data_2"]
    shared_group_params: "user_data"
  user_data_tpl_env:
    type: "template"
    origin: "env"
    file: "{{ params.env.repo_dir }}/test/files/user-data.tpl.sh"
    params:
      prop1: "value_double_env_1"
    group_params:
      prop1: "user_data_1"
      prop2: "user_data_2"
    shared_params: ["user_data_1", "user_data_2"]
    shared_group_params: "user_data"
  str_overridden: |
    My Original Value
    Line 02
  tpl_overridden_nested:
    type: "env"
    name: "tpl_overridden"
    params:
      param_middle: "value middle"
      param_overridden_middle: "value overridden middle"
      param_overridden_top: "value overridden top (middle)"
    credentials:
      credential_middle: "my_credential_middle"
      credential_overridden_middle: "my_credential_overridden_middle"
      credential_overridden_top: "my_wrong_credential"
    contents:
      content_middle: |
        Content Middle
        Line 02
      content_overridden_middle: |
        Content Overridden Middle
        Line 02
      content_overridden_top: |
        Content Overridden Top (Middle)
        Line 02
  tpl_overridden:
    type: "template"
    origin: "env"
    file: "{{ params.env.repo_dir }}/test/files/dynamic.tpl.yml"
    params:
      param_bottom: "value bottom"
      param_overridden_middle: "value overridden middle (bottom)"
      param_overridden_top: "value overridden top (bottom)"
    credentials:
      credential_bottom: "my_credential_bottom"
      credential_overridden_middle: "my_wrong_credential"
      credential_overridden_top: "my_wrong_credential"
    contents:
      content_bottom: |
        Content Bottom
        Line 02
      content_overridden_middle: |
        Content Overridden Middle (Bottom)
        Line 02
      content_overridden_top: |
        Content Overridden Top (Bottom)
        Line 02
content_shared_group_params:
  user_data:
    prop1: "user_data_shared_1"
    prop2: "user_data_shared_2"
    prop3: "user_data_shared_3"
    prop4: "user_data_shared_4"
    prop5: "user_data_shared_5"
  user_data_overridden:
    prop1: "user_data_shared_overridden_1"
    prop2: "user_data_shared_overridden_2"
    prop3: "user_data_shared_overridden_3"
    prop4: "user_data_shared_overridden_4"
    prop5: "user_data_shared_overridden_5"
content_shared_params:
  user_data_str:
    value: |
      User Data Shared 1
      User Data Shared 2
      User Data Shared 3
  user_data_env_str:
    value: |
      User Data Env Shared 1
      User Data Env Shared 2
      User Data Env Shared 3
  user_data_1:
    prop1: "value_shared_1_1"
    prop2: "value_shared_1_2"
    prop3: "value_shared_1_3"
    prop4: "value_shared_1_4"
  user_data_2:
    prop2: "value_shared_2_2"
    prop4: "value_shared_2_4"
  user_data_overridden_1:
    prop1: "value_shared_overridden_1_1"
    prop2: "value_shared_overridden_1_2"
    prop3: "value_shared_overridden_1_3"
    prop4: "value_shared_overridden_1_4"
  user_data_overridden_2:
    prop2: "value_shared_overridden_2_2"
    prop4: "value_shared_overridden_2_4"
content_group_params:
  user_data_1: "value_group_1"
  user_data_2: "value_group_2"
  user_data_shared_1: "value_shared_group_1"
  user_data_shared_2: "value_shared_group_2"
  user_data_shared_3: "value_shared_group_3"
  user_data_shared_4: "value_shared_group_4"
  user_data_shared_5: "value_shared_group_5"
  user_data_overridden_1: "value_group_overridden_1"
  user_data_overridden_2: "value_group_overridden_2"
  user_data_shared_overridden_1: "value_shared_group_overridden_1"
  user_data_shared_overridden_2: "value_shared_group_overridden_2"
  user_data_shared_overridden_3: "value_shared_group_overridden_3"
  user_data_shared_overridden_4: "value_shared_group_overridden_4"
  user_data_shared_overridden_5: "value_shared_group_overridden_5"
repos:
  env_base:
    src: "https://github.com/lucasbasquerotto/env-base.git"
    version: "master"
  cloud:
    src: "https://github.com/lucasbasquerotto/cloud.git"
    version: "master"
  custom_cloud:
    src: "https://github.com/lucasbasquerotto/custom-cloud.git"
    version: "master"
  pod:
    src: "https://github.com/lucasbasquerotto/pod.git"
    version: "master"
  custom_pod:
    src: "https://github.com/lucasbasquerotto/custom-pod.git"
    version: "master"
credentials:
  fake: {}
  fake_user:
    host_user: "test"
    host_pass: "123456"
  localhost:
    host_user: "root"
  host: "{{ params.credentials.host | default({}) }}"
  my_credential_1_1: "my_secret_1_1"
  my_credential_1_2: "my_secret_1_2"
  my_credential_2_1: "my_secret_2_1"
  my_credential_2_2: "my_secret_2_2"
  my_credential_3_1: "my_secret_3_1"
  my_credential_3_2: "my_secret_3_2"
  my_credential_top_1_1: "my_secret_top_1_1"
  my_credential_top_1_2: "my_secret_top_1_2"
  my_credential_middle_1_1: "my_secret_middle_1_1"
  my_credential_middle_1_2: "my_secret_middle_1_2"
  my_credential_bottom_1_1: "my_secret_bottom_1_1"
  my_credential_bottom_1_2: "my_secret_bottom_1_2"
  my_credential_top_2_1: "my_secret_top_2_1"
  my_credential_top_2_2: "my_secret_top_2_2"
  my_credential_middle_2_1: "my_secret_middle_2_1"
  my_credential_middle_2_2: "my_secret_middle_2_2"
  my_credential_bottom_2_1: "my_secret_bottom_2_1"
  my_credential_bottom_2_2: "my_secret_bottom_2_2"
  my_credential_pod_node_1: "my_secret_pod_node_1"
  my_credential_pod_node_2: "my_secret_pod_node_2"
  my_credential_pod_overridden_1: "my_secret_pod_overridden_1"
  my_credential_pod_overridden_2: "my_secret_pod_overridden_2"
  my_credential_pod_overridden_ctx_1: "my_secret_pod_overridden_ctx_1"
  my_credential_pod_overridden_ctx_2: "my_secret_pod_overridden_ctx_2"
  my_credential_overridden: "my_secret_overridden"
  my_credential_initial: "my_secret_initial"
  my_credential_final: "my_secret_final"
  my_credential_top: "my secret top"
  my_credential_overridden_top: "my secret overridden top"
  my_credential_middle: "my secret middle"
  my_credential_overridden_middle: "my secret overridden middle"
  my_credential_bottom: "my secret bottom"
  my_wrong_credential: "my wrong secret"
  digital_ocean: "{{ params.credentials.digital_ocean | default({}) }}"
  s3: "{{ params.credentials.s3 | default({}) }}"
  godaddy: "{{ params.credentials.godaddy | default({}) }}"
  cloudflare: "{{ params.credentials.cloudflare | default({}) }}"
  node_service_local_credential: { test_token: "1234556" }
  test_task_prop1_cloud: "value1_credential_cloud"
  test_task_prop1_env: "value1_credential_env"
  test_task_prop1_pod: "value1_credential_pod"
  test_task_prop2:
    inner_prop1: "inner2_value1"
    inner_prop2:
      inner_prop1: "inner2_2_value1"
      inner_prop2:
        inner_prop1: "inner2_2_2_value1"
        inner_prop3:
          inner_prop1: "inner2_2_2_3_value1"
    inner_prop3:
      inner_prop1: "inner2_3_value1"
  test_task_prop4: "value4_credential"
  test_task_prop5: "value5_credential"
  test_task_overridden: "value_credential_overridden"
  test_task_run_stage: "value_credential_run_stage"
  node_cred_content_1:
    secret1: "1234556"
    secret2: 2
  node_cred_content_2:
    secret1: "1234556"
